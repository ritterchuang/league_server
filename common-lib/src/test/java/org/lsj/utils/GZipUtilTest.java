package org.lsj.utils;

import org.junit.jupiter.api.Test;

import javax.xml.bind.DatatypeConverter;
import java.io.IOException;

import static org.junit.jupiter.api.Assertions.assertEquals;

class GZipUtilTest {

    @Test
    void GivenString_WhenCompress_And_Decompress_ThenCompareInputStringAndDecompressString() throws IOException {
        String plain = "[{\"spinCost\":5.0,\"baseGameTotalWin\":5.0,\"screenColumn_1\":\"KING,TEN,QUEEN,鲤鱼\",\"screenColumn_2\":\"JOKER,铜锣,KING,凤凰\",\"screenColumn_3\":\"KING,TEN,铜锣,ACE\",\"screenColumn_4\":\"ACE,KING,TEN,铜锣\",\"screenColumn_5\":\"TEN,JOKER,凤凰,TEN\",\"upperDamp\":\"狮子,QUEEN,ACE,凤凰,摇钱树\",\"lowerDamp\":\"TEN,铜锣,TEN,KING,JOKER\"},{\"roundIndex\":1,\"totalRound\":8,\"roundTotalWin\":0.0,\"screenColumn_1\":\"鲤鱼,ACE,KING,狮子\",\"screenColumn_2\":\"JOKER,TEN,鲤鱼,TEN\",\"screenColumn_3\":\"摇钱树,KING,ACE,凤凰\",\"screenColumn_4\":\"摇钱树,QUEEN,ACE,凤凰\",\"screenColumn_5\":\"鲤鱼,TEN,ACE,凤凰\",\"upperDamp\":\"KING,凤凰,QUEEN,KING,QUEEN\",\"lowerDamp\":\"ACE,TEN,KING,QUEEN,TEN\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":2,\"totalRound\":8,\"roundTotalWin\":0.0,\"screenColumn_1\":\"TEN,凤凰,KING,JOKER\",\"screenColumn_2\":\"狮子,狮子,QUEEN,凤凰\",\"screenColumn_3\":\"JOKER,QUEEN,摇钱树,TEN\",\"screenColumn_4\":\"ACE,凤凰,KING,QUEEN\",\"screenColumn_5\":\"凤凰,KING,TEN,摇钱树\",\"upperDamp\":\"JOKER,JOKER,凤凰,QUEEN,JOKER\",\"lowerDamp\":\"凤凰,狮子,QUEEN,凤凰,KING\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":3,\"totalRound\":8,\"roundTotalWin\":0.2,\"screenColumn_1\":\"狮子,狮子,QUEEN,TEN\",\"screenColumn_2\":\"JOKER,TEN,摇钱树,ACE\",\"screenColumn_3\":\"摇钱树,KING,ACE,凤凰\",\"screenColumn_4\":\"狮子,狮子,ACE,KING\",\"screenColumn_5\":\"KING,鲤鱼,TEN,JOKER\",\"upperDamp\":\"KING,鲤鱼,QUEEN,狮子,JOKER\",\"lowerDamp\":\"狮子,TEN,KING,狮子,鲤鱼\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":4,\"totalRound\":8,\"roundTotalWin\":0.7,\"screenColumn_1\":\"TEN,KING,JOKER,狮子\",\"screenColumn_2\":\"ACE,JOKER,凤凰,TEN\",\"screenColumn_3\":\"JOKER,摇钱树,KING,ACE\",\"screenColumn_4\":\"狮子,狮子,狮子,ACE\",\"screenColumn_5\":\"鲤鱼,JOKER,QUEEN,凤凰\",\"upperDamp\":\"铜锣,鲤鱼,QUEEN,QUEEN,TEN\",\"lowerDamp\":\"KING,JOKER,摇钱树,狮子,JOKER\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":5,\"totalRound\":8,\"roundTotalWin\":0.0,\"screenColumn_1\":\"摇钱树,KING,JOKER,鲤鱼\",\"screenColumn_2\":\"JOKER,TEN,凤凰,QUEEN\",\"screenColumn_3\":\"TEN,QUEEN,摇钱树,KING\",\"screenColumn_4\":\"鞭炮,KING,TEN,铜锣\",\"screenColumn_5\":\"凤凰,铜锣,JOKER,摇钱树\",\"upperDamp\":\"TEN,鲤鱼,摇钱树,ACE,JOKER\",\"lowerDamp\":\"KING,TEN,QUEEN,KING,铜锣\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":6,\"totalRound\":13,\"roundTotalWin\":2.2,\"screenColumn_1\":\"TEN,狮子,狮子,JOKER\",\"screenColumn_2\":\"TEN,JOKER,摇钱树,QUEEN\",\"screenColumn_3\":\"鲤鱼,JOKER,KING,凤凰\",\"screenColumn_4\":\"JOKER,凤凰,ACE,TEN\",\"screenColumn_5\":\"狮子,KING,QUEEN,凤凰\",\"upperDamp\":\"JOKER,凤凰,QUEEN,KING,JOKER\",\"lowerDamp\":\"狮子,JOKER,JOKER,凤凰,KING\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":7,\"totalRound\":13,\"roundTotalWin\":4.5,\"screenColumn_1\":\"TEN,狮子,狮子,JOKER\",\"screenColumn_2\":\"JOKER,狮子,狮子,QUEEN\",\"screenColumn_3\":\"凤凰,KING,JOKER,摇钱树\",\"screenColumn_4\":\"摇钱树,ACE,KING,鲤鱼\",\"screenColumn_5\":\"凤凰,JOKER,KING,鲤鱼\",\"upperDamp\":\"JOKER,TEN,JOKER,QUEEN,TEN\",\"lowerDamp\":\"狮子,狮子,KING,ACE,JOKER\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":8,\"totalRound\":13,\"roundTotalWin\":0.0,\"screenColumn_1\":\"摇钱树,KING,JOKER,鲤鱼\",\"screenColumn_2\":\"JOKER,狮子,狮子,QUEEN\",\"screenColumn_3\":\"凤凰,KING,ACE,摇钱树\",\"screenColumn_4\":\"凤凰,ACE,TEN,鲤鱼\",\"screenColumn_5\":\"狮子,狮子,狮子,JOKER\",\"upperDamp\":\"TEN,摇钱树,QUEEN,JOKER,JOKER\",\"lowerDamp\":\"KING,狮子,KING,ACE,狮子\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":9,\"totalRound\":13,\"roundTotalWin\":0.7,\"screenColumn_1\":\"QUEEN,TEN,狮子,狮子\",\"screenColumn_2\":\"QUEEN,TEN,凤凰,JOKER\",\"screenColumn_3\":\"QUEEN,ACE,KING,铜锣\",\"screenColumn_4\":\"狮子,TEN,JOKER,狮子\",\"screenColumn_5\":\"铜锣,JOKER,摇钱树,KING\",\"upperDamp\":\"鲤鱼,摇钱树,铜锣,狮子,凤凰\",\"lowerDamp\":\"TEN,TEN,ACE,TEN,JOKER\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":10,\"totalRound\":18,\"roundTotalWin\":2.5,\"screenColumn_1\":\"狮子,QUEEN,KING,狮子\",\"screenColumn_2\":\"狮子,QUEEN,凤凰,TEN\",\"screenColumn_3\":\"凤凰,QUEEN,KING,摇钱树\",\"screenColumn_4\":\"JOKER,KING,鲤鱼,JOKER\",\"screenColumn_5\":\"铜锣,QUEEN,JOKER,凤凰\",\"upperDamp\":\"KING,狮子,ACE,鞭炮,TEN\",\"lowerDamp\":\"QUEEN,QUEEN,QUEEN,KING,QUEEN\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":11,\"totalRound\":18,\"roundTotalWin\":0.0,\"screenColumn_1\":\"TEN,KING,JOKER,狮子\",\"screenColumn_2\":\"QUEEN,ACE,凤凰,QUEEN\",\"screenColumn_3\":\"KING,ACE,鲤鱼,QUEEN\",\"screenColumn_4\":\"狮子,狮子,ACE,鞭炮\",\"screenColumn_5\":\"KING,TEN,摇钱树,KING\",\"upperDamp\":\"铜锣,鲤鱼,摇钱树,JOKER,凤凰\",\"lowerDamp\":\"KING,ACE,ACE,狮子,TEN\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":12,\"totalRound\":18,\"roundTotalWin\":0.0,\"screenColumn_1\":\"鲤鱼,JOKER,ACE,凤凰\",\"screenColumn_2\":\"JOKER,摇钱树,ACE,铜锣\",\"screenColumn_3\":\"TEN,QUEEN,鲤鱼,KING\",\"screenColumn_4\":\"鲤鱼,QUEEN,ACE,凤凰\",\"screenColumn_5\":\"JOKER,TEN,狮子,KING\",\"upperDamp\":\"TEN,TEN,鲤鱼,KING,凤凰\",\"lowerDamp\":\"JOKER,摇钱树,QUEEN,QUEEN,TEN\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":13,\"totalRound\":18,\"roundTotalWin\":0.2,\"screenColumn_1\":\"JOKER,TEN,狮子,狮子\",\"screenColumn_2\":\"摇钱树,QUEEN,TEN,凤凰\",\"screenColumn_3\":\"ACE,JOKER,凤凰,KING\",\"screenColumn_4\":\"QUEEN,摇钱树,JOKER,KING\",\"screenColumn_5\":\"QUEEN,凤凰,JOKER,TEN\",\"upperDamp\":\"狮子,JOKER,KING,鞭炮,JOKER\",\"lowerDamp\":\"TEN,QUEEN,JOKER,摇钱树,凤凰\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":14,\"totalRound\":18,\"roundTotalWin\":0.0,\"screenColumn_1\":\"摇钱树,KING,QUEEN,狮子\",\"screenColumn_2\":\"鲤鱼,ACE,JOKER,凤凰\",\"screenColumn_3\":\"狮子,狮子,QUEEN,TEN\",\"screenColumn_4\":\"QUEEN,ACE,凤凰,KING\",\"screenColumn_5\":\"QUEEN,凤凰,TEN,JOKER\",\"upperDamp\":\"TEN,TEN,狮子,鲤鱼,KING\",\"lowerDamp\":\"KING,ACE,狮子,ACE,凤凰\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":15,\"totalRound\":18,\"roundTotalWin\":80.0,\"screenColumn_1\":\"KING,鲤鱼,ACE,KING\",\"screenColumn_2\":\"KING,鲤鱼,JOKER,TEN\",\"screenColumn_3\":\"摇钱树,ACE,KING,QUEEN\",\"screenColumn_4\":\"KING,鞭炮,QUEEN,摇钱树\",\"screenColumn_5\":\"JOKER,凤凰,KING,QUEEN\",\"upperDamp\":\"ACE,TEN,JOKER,鲤鱼,TEN\",\"lowerDamp\":\"鲤鱼,鲤鱼,ACE,鞭炮,凤凰\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,2,0,0\"},{\"roundIndex\":16,\"totalRound\":18,\"roundTotalWin\":0.2,\"screenColumn_1\":\"TEN,摇钱树,KING,QUEEN\",\"screenColumn_2\":\"JOKER,摇钱树,QUEEN,TEN\",\"screenColumn_3\":\"ACE,JOKER,凤凰,KING\",\"screenColumn_4\":\"QUEEN,ACE,铜锣,KING\",\"screenColumn_5\":\"QUEEN,JOKER,凤凰,铜锣\",\"upperDamp\":\"QUEEN,TEN,KING,摇钱树,铜锣\",\"lowerDamp\":\"摇钱树,摇钱树,JOKER,ACE,JOKER\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":17,\"totalRound\":23,\"roundTotalWin\":2.0,\"screenColumn_1\":\"TEN,摇钱树,KING,QUEEN\",\"screenColumn_2\":\"JOKER,狮子,狮子,QUEEN\",\"screenColumn_3\":\"QUEEN,KING,摇钱树,ACE\",\"screenColumn_4\":\"QUEEN,ACE,凤凰,KING\",\"screenColumn_5\":\"JOKER,凤凰,铜锣,JOKER\",\"upperDamp\":\"QUEEN,摇钱树,凤凰,摇钱树,QUEEN\",\"lowerDamp\":\"摇钱树,狮子,KING,ACE,凤凰\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":18,\"totalRound\":23,\"roundTotalWin\":0.5,\"screenColumn_1\":\"JOKER,TEN,凤凰,ACE\",\"screenColumn_2\":\"ACE,QUEEN,凤凰,TEN\",\"screenColumn_3\":\"QUEEN,摇钱树,TEN,QUEEN\",\"screenColumn_4\":\"狮子,狮子,ACE,JOKER\",\"screenColumn_5\":\"KING,TEN,铜锣,QUEEN\",\"upperDamp\":\"ACE,摇钱树,JOKER,狮子,摇钱树\",\"lowerDamp\":\"TEN,QUEEN,摇钱树,狮子,TEN\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":19,\"totalRound\":23,\"roundTotalWin\":0.2,\"screenColumn_1\":\"鲤鱼,TEN,KING,鲤鱼\",\"screenColumn_2\":\"ACE,凤凰,TEN,JOKER\",\"screenColumn_3\":\"ACE,KING,铜锣,QUEEN\",\"screenColumn_4\":\"KING,JOKER,凤凰,QUEEN\",\"screenColumn_5\":\"摇钱树,KING,鲤鱼,ACE\",\"upperDamp\":\"KING,QUEEN,QUEEN,铜锣,ACE\",\"lowerDamp\":\"TEN,凤凰,KING,JOKER,KING\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":20,\"totalRound\":23,\"roundTotalWin\":0.2,\"screenColumn_1\":\"TEN,JOKER,铜锣,KING\",\"screenColumn_2\":\"TEN,摇钱树,JOKER,QUEEN\",\"screenColumn_3\":\"凤凰,KING,ACE,摇钱树\",\"screenColumn_4\":\"凤凰,QUEEN,ACE,鲤鱼\",\"screenColumn_5\":\"JOKER,KING,鲤鱼,TEN\",\"upperDamp\":\"凤凰,QUEEN,QUEEN,ACE,凤凰\",\"lowerDamp\":\"JOKER,摇钱树,KING,QUEEN,KING\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":21,\"totalRound\":23,\"roundTotalWin\":120.0,\"screenColumn_1\":\"JOKER,摇钱树,KING,JOKER\",\"screenColumn_2\":\"QUEEN,凤凰,JOKER,TEN\",\"screenColumn_3\":\"KING,JOKER,摇钱树,ACE\",\"screenColumn_4\":\"ACE,鞭炮,KING,TEN\",\"screenColumn_5\":\"JOKER,凤凰,KING,JOKER\",\"upperDamp\":\"QUEEN,鞭炮,鞭炮,QUEEN,ACE\",\"lowerDamp\":\"摇钱树,凤凰,JOKER,鞭炮,凤凰\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,3,0,0\"},{\"roundIndex\":22,\"totalRound\":23,\"roundTotalWin\":2.0,\"screenColumn_1\":\"KING,JOKER,鲤鱼,QUEEN\",\"screenColumn_2\":\"JOKER,QUEEN,鲤鱼,TEN\",\"screenColumn_3\":\"ACE,凤凰,TEN,QUEEN\",\"screenColumn_4\":\"鲤鱼,JOKER,QUEEN,摇钱树\",\"screenColumn_5\":\"TEN,JOKER,狮子,KING\",\"upperDamp\":\"凤凰,凤凰,KING,KING,凤凰\",\"lowerDamp\":\"JOKER,QUEEN,凤凰,JOKER,JOKER\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"},{\"roundIndex\":23,\"totalRound\":23,\"roundTotalWin\":0.2,\"screenColumn_1\":\"狮子,JOKER,TEN,狮子\",\"screenColumn_2\":\"摇钱树,ACE,铜锣,TEN\",\"screenColumn_3\":\"KING,鲤鱼,凤凰,ACE\",\"screenColumn_4\":\"QUEEN,ACE,鲤鱼,KING\",\"screenColumn_5\":\"ACE,JOKER,摇钱树,KING\",\"upperDamp\":\"狮子,JOKER,QUEEN,凤凰,鲤鱼\",\"lowerDamp\":\"JOKER,ACE,鲤鱼,ACE,JOKER\",\"multiplier_2\":\"0,0,0,0\",\"multiplier_3\":\"0,0,0,0\",\"multiplier_4\":\"0,0,0,0\"}]";

        final byte[] compressBytes = GZipUtil.compress(plain);

        assertEquals(plain, GZipUtil.decompress(compressBytes));
    }

    @Test
    void convertHexStringAndDecompress() throws IOException {
        String expected = "[{\"spinCost\":50.0,\"baseGameTotalWin\":2.0}]";

        final String hex = "0x1F8B08000000000000008BAE562A2EC8CC73CE2F2E51B23235D033D0514A4A2C4E754FCC4D0DC92F49CC09CFCC53B232D233A88D05007D65A2A72A000000";
        final String removeFirstTwoChar = hex.substring(2);
        final String actual = GZipUtil.decompress(DatatypeConverter.parseHexBinary(removeFirstTwoChar));

        assertEquals(expected, actual);
    }

}
